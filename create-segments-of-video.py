from moviepy.video.io.VideoFileClip import VideoFileClip
import os

# List of dictionaries containing start and end times
time_ranges_with_info = [
    {"start":4.930342557424959,"end":6.262720666380185,"channel":0,"labels":["Passes completed"]},
    {"start":10.678914599240304,"end":14.83226599282335,"channel":0,"labels":["Passes completed"]},
    {"start":14.833775017074574,"end":17.070001150168405,"channel":0,"labels":["Passes completed"]},
    {"start":20.61533326608067,"end":22.86741434871323,"channel":0,"labels":["Passes completed"]},
    {"start":76.74268761672869,"end":77.92799344969318,"channel":0,"labels":["Passes completed"]},
    {"start":78.7168312725241,"end":80.2840689849994,"channel":0,"labels":["Ground duels won"]},
    {"start":81.62097445234039,"end":83.88060147149832,"channel":0,"labels":["Ball interception"]},
    {"start":84.56715062159735,"end":85.09395321402602,"channel":0,"labels":["Ground duels won"]},
    {"start":85.21820159375811,"end":85.87670483429396,"channel":0,"labels":["Ground duels won"]},
    {"start":107.13739947415397,"end":108.6651269921971,"channel":0,"labels":["Passes completed"]},
    {"start":126.59781188882893,"end":128.24876618209936,"channel":0,"labels":["Passes completed"]},
    {"start":147.00998945382523,"end":148.6315843003268,"channel":0,"labels":["Passes completed"]},
    {"start":150.91487127706455,"end":152.31089814700053,"channel":0,"labels":["Ball interception"]},
    {"start":172.87018500957225,"end":174.51644311091184,"channel":0,"labels":["Passes completed"]},
    {"start":174.32889954008658,"end":175.5575733220224,"channel":0,"labels":["Passes completed"]},
    {"start":176.73015442627548,"end":178.03399084253644,"channel":0,"labels":["Ground duels won"]},
    {"start":178.9717253144759,"end":180.53896302695122,"channel":0,"labels":["Dribbles completed"]},
    {"start":181.9982897216044,"end":184.88253391515138,"channel":0,"labels":["Ground duels won"]},
    {"start":189.6285990926681,"end":191.5285269612546,"channel":0,"labels":["Ball interception"]},
    {"start":191.5855920886384,"end":193.50842155100307,"channel":0,"labels":["Ground duels won"]},
    {"start":254.96853537696728,"end":258.0549419483294,"channel":0,"labels":["Passes completed"]},
    {"start":271.10039562070796,"end":272.5095925554546,"channel":0,"labels":["Passes completed"]},
    {"start":272.976668244401,"end":274.28050466066196,"channel":0,"labels":["Passes completed"]},
    {"start":279.550930215057,"end":280.64404559434644,"channel":0,"labels":["Ground duels won"]},
    {"start":281.07290847695293,"end":285.27415915157155,"channel":0,"labels":["Dribbles completed"]},
    {"start":286.469360272503,"end":288.5571923705592,"channel":0,"labels":["Passes completed"]},
    {"start":306.3171902076904,"end":308.71414200324085,"channel":0,"labels":["Passes completed"]},
    {"start":314.0788913286206,"end":315.46174813374586,"channel":0,"labels":["Passes completed"]},
    {"start":316.16004818958737,"end":317.82123330411116,"channel":0,"labels":["Ball interception"]},
    {"start":318.65688427750666,"end":320.98798574900354,"channel":0,"labels":["Dribbles completed"]},
    {"start":347.4354357224857,"end":348.91048298128595,"channel":0,"labels":["Passes completed"]},
    {"start":349.57556548239137,"end":351.1800477232666,"channel":0,"labels":["Passes completed"]},
    {"start":352.9557313610168,"end":353.8381257033348,"channel":0,"labels":["Dribbles completed"]},
    {"start":353.76707518237805,"end":355.3526831565672,"channel":0,"labels":["Passes completed"]},
    {"start":356.310331483274,"end":358.03560997347796,"channel":0,"labels":["Dribbles completed"]},
    {"start":362.5076213173137,"end":365.38716931892975,"channel":0,"labels":["Passes completed"]},
    {"start":369.8057148343915,"end":373.45834469365155,"channel":0,"labels":["Passes completed"]},
    {"start":375.5775517234764,"end":376.8023677508731,"channel":0,"labels":["Dribbles completed"]},
    {"start":376.53795932768855,"end":378.340326973144,"channel":0,"labels":["Passes completed"]},
    {"start":380.67027193333627,"end":381.7624640889576,"channel":0,"labels":["Ball interception"]},
    {"start":401.70499285177044,"end":406.6042569613571,"channel":0,"labels":["Dribbles completed"]},
    {"start":440.04907079900437,"end":443.21039035854864,"channel":0,"labels":["Passes completed"]},
    {"start":450.93821572558215,"end":453.82245991912913,"channel":0,"labels":["Ball interception"]},
    {"start":453.99466775367796,"end":456.7506848698708,"channel":0,"labels":["Dribbles completed"]},
    {"start":487.2203684902094,"end":488.7387826489307,"channel":0,"labels":["Passes completed"]},
    {"start":489.42620926435495,"end":490.83563009204687,"channel":0,"labels":["Passes completed"]},
    {"start":499.17819590919726,"end":500.2999918208134,"channel":0,"labels":["Ground duels won"]},
    {"start":510.94409010396924,"end":513.1738325949593,"channel":0,"labels":["Passes completed"]},
    {"start":513.8042822045917,"end":516.6712506158444,"channel":0,"labels":["Passes completed"]},
    {"start":519.4595543224366,"end":523.2404220245504,"channel":0,"labels":["Passes completed"]},
    {"start":530.5520524419173,"end":532.8233429296341,"channel":0,"labels":["Passes completed"]},
    {"start":533.6822128101537,"end":534.9677075678106,"channel":0,"labels":["Ball interception"]},
    {"start":548.7709212697762,"end":550.7090315449751,"channel":0,"labels":["Passes completed"]},
    {"start":551.1652567655545,"end":552.7366534309402,"channel":0,"labels":["Passes completed"]},
    {"start":555.7789930194699,"end":558.7258202569786,"channel":0,"labels":["Passes completed"]},
    {"start":567.0324884501129,"end":568.4451203388147,"channel":0,"labels":["Passes completed"]},
    {"start":570.2106633208259,"end":572.2025784475819,"channel":0,"labels":["Passes completed"]},
    {"start":578.7161249535862,"end":581.5857953552011,"channel":0,"labels":["Passes completed"]},
    {"start":582.2800251272024,"end":584.537466282677,"channel":0,"labels":["Passes completed"]},
    {"start":590.1832801195244,"end":591.7759533273746,"channel":0,"labels":["Ground duels won"]},
    {"start":593.3189700082557,"end":595.4102191768242,"channel":0,"labels":["Ground duels won"]},
    {"start":610.6715830917731,"end":612.8182295893102,"channel":0,"labels":["Passes completed"]},
    {"start":613.188066602419,"end":615.7737016886805,"channel":0,"labels":["Passes completed"]},
    {"start":616.3807810432648,"end":618.9250247699223,"channel":0,"labels":["Passes completed"]},
    {"start":618.7233098589553,"end":620.7144548531926,"channel":0,"labels":["Passes completed"]},
    {"start":620.62602667103,"end":622.2595038492752,"channel":0,"labels":["Passes completed"]},
    {"start":622.6255843840516,"end":625.6684562838014,"channel":0,"labels":["Passes completed"]},
    {"start":628.8790468893778,"end":631.3695118706651,"channel":0,"labels":["Passes completed"]},
    {"start":631.4006573374493,"end":633.3118651868695,"channel":0,"labels":["Passes completed"]},
    {"start":634.2540440048774,"end":636.7992145011759,"channel":0,"labels":["Passes completed"]},
    {"start":697.1944448772203,"end":705.3655509001035,"channel":0,"labels":["Dribbles completed"]},
    {"start":794.1377537347996,"end":796.0766602487041,"channel":0,"labels":["Ball interception"]},
    {"start":796.6291558608274,"end":799.8006529442854,"channel":0,"labels":["Ground duels won"]},
    {"start":804.3621965066019,"end":807.0238919689002,"channel":0,"labels":["Passes completed"]},
    {"start":807.7453227991757,"end":810.0826488870935,"channel":0,"labels":["Passes completed"]},
    {"start":812.7605669508088,"end":814.5128011740485,"channel":0,"labels":["Passes completed"]},
    {"start":815.4689072749694,"end":817.4355124533583,"channel":0,"labels":["Passes completed"]},
    {"start":817.752124004796,"end":819.9160919574559,"channel":0,"labels":["Passes completed"]},
    {"start":820.3152303060806,"end":823.8883580245617,"channel":0,"labels":["Dribbles completed"]},
    {"start":823.887506189587,"end":825.8924483036925,"channel":0,"labels":["Passes completed"]},
    {"start":825.7696263359442,"end":827.2515048858569,"channel":0,"labels":["Passes completed"]},
    {"start":827.5390381015193,"end":829.2148073028225,"channel":0,"labels":["Dribbles completed"]},
    {"start":829.3533006252442,"end":830.8767271718834,"channel":0,"labels":["Passes completed"]},
    {"start":832.1579139797335,"end":835.4136165695953,"channel":0,"labels":["Passes completed"]},
    {"start":845.8297415630619,"end":851.4387211211429,"channel":0,"labels":["Dribbles completed"]},
    {"start":868.9840270360617,"end":872.2663187774571,"channel":0,"labels":["Ball interception"]},
    {"start":872.3814145532538,"end":875.6066381697078,"channel":0,"labels":["Passes completed"]},
    {"start":876.0289415272166,"end":878.3866173879576,"channel":0,"labels":["Passes completed"]},
    {"start":879.6161015401937,"end":883.7183233520814,"channel":0,"labels":["Passes completed"]},
    {"start":887.3073705090908,"end":890.2825621188542,"channel":0,"labels":["Passes completed"]},
    {"start":890.0792014481032,"end":892.6242936258404,"channel":0,"labels":["Passes completed"]},
    {"start":893.1289104923891,"end":896.0170510213578,"channel":0,"labels":["Passes completed"]},
    {"start":897.2604486727137,"end":900.1086075761802,"channel":0,"labels":["Passes completed"]},
    {"start":901.2270618958511,"end":904.4606655983555,"channel":0,"labels":["Passes completed"]},
    {"start":900.2955735614495,"end":901.514314798761,"channel":0,"labels":["Dribbles completed"]},
    {"start":904.2319003535996,"end":909.1761119640561,"channel":0,"labels":["Dribbles completed"]},
    {"start":921.3656926631567,"end":924.5675120829001,"channel":0,"labels":["Passes completed"]},
    {"start":924.4755068725232,"end":928.084739447726,"channel":0,"labels":["Passes completed"]},
    {"start":928.0330611249782,"end":931.0912443034462,"channel":0,"labels":["Passes completed"]},
    {"start":931.7980585174378,"end":934.7366623060183,"channel":0,"labels":["Passes completed"]},
    {"start":937.0619575138952,"end":938.8194129745497,"channel":0,"labels":["Passes completed"]},
    {"start":938.4225597717609,"end":939.863764882214,"channel":0,"labels":["Passes completed"]},
    {"start":942.1353229583483,"end":944.7626626784588,"channel":0,"labels":["Passes completed"]},
    {"start":946.0768896580262,"end":948.7359614485238,"channel":0,"labels":["Dribbles completed"]},
    {"start":952.0135591048391,"end":953.827821628564,"channel":0,"labels":["Dribbles completed"]},
    {"start":953.2895577369483,"end":956.3675816175918,"channel":0,"labels":["Passes completed"]},
    {"start":956.3345507643977,"end":957.9826213012163,"channel":0,"labels":["Passes completed"]},
    {"start":958.6404645827198,"end":961.9781536530841,"channel":0,"labels":["Passes completed"]},
    {"start":982.808245609787,"end":985.0476996023682,"channel":0,"labels":["Passes completed"]},
    {"start":986.9783710558866,"end":991.354760044414,"channel":0,"labels":["Ground duels won"]},
    {"start":1007.0208142834044,"end":1009.7768313995973,"channel":0,"labels":["Ground duels won"]},
    {"start":1011.4844840526049,"end":1014.2308679857679,"channel":0,"labels":["Passes completed"]},
    {"start":1014.9739622261475,"end":1017.8961713292464,"channel":0,"labels":["Passes completed"]},
    {"start":1018.3479301693274,"end":1021.1145855567524,"channel":0,"labels":["Passes completed"]},
    {"start":1022.2033510062713,"end":1026.9310901135193,"channel":0,"labels":["Passes completed"]},
    {"start":1027.0203230015522,"end":1030.0542535322297,"channel":0,"labels":["Passes completed"]},
    {"start":1030.2550688497408,"end":1031.8615913898334,"channel":0,"labels":["Dribbles completed"]},
    {"start":1052.0828716304586,"end":1055.477915993822,"channel":0,"labels":["Ball interception"]},
    {"start":1055.4467900281848,"end":1062.703840123084,"channel":0,"labels":["Dribbles completed"]},
    {"start":1085.7963013916376,"end":1089.6609177418816,"channel":0,"labels":["Passes completed"]},
    {"start":1091.296970681917,"end":1093.997590469141,"channel":0,"labels":["Ground duels won"]},
    {"start":1100.177990137861,"end":1106.7702722851366,"channel":0,"labels":["Dribbles completed"]},
    {"start":1108.841778899914,"end":1111.7631395519334,"channel":0,"labels":["Passes completed"]},
    {"start":1112.6374408919955,"end":1115.6412318296975,"channel":0,"labels":["Passes completed"]},
    {"start":1117.5702655814207,"end":1124.5226303669926,"channel":0,"labels":["Dribbles completed"]},
    {"start":1178.8451882168335,"end":1180.8873577537051,"channel":0,"labels":["Passes completed"]},
    {"start":1185.4368933085987,"end":1188.7338306209424,"channel":0,"labels":["Passes completed"]},
    {"start":1202.4145116244829,"end":1205.8075980238157,"channel":0,"labels":["Passes completed"]},
    {"start":1207.7007326113992,"end":1211.9109296130205,"channel":0,"labels":["Dribbles completed"]},
    {"start":1248.0697417701924,"end":1252.1829934461184,"channel":0,"labels":["Dribbles completed"]},
    {"start":1260.1428849158751,"end":1266.001439180995,"channel":0,"labels":["Dribbles completed"]},
    {"start":1340.1918141613971,"end":1343.3217632481287,"channel":0,"labels":["Passes completed"]},
    {"start":1344.2782903676273,"end":1347.3805407898744,"channel":0,"labels":["Ground duels won"]},
    {"start":1347.43579629547,"end":1349.3071791565108,"channel":0,"labels":["Passes completed"]},
    {"start":1382.9621346851466,"end":1385.3996171597692,"channel":0,"labels":["Passes completed"]},
    {"start":1386.2652004249053,"end":1388.7165322317703,"channel":0,"labels":["Ground duels won"]},
    {"start":1403.414397732727,"end":1407.0983201091453,"channel":0,"labels":["Passes completed"]},
    {"start":1418.0640654020042,"end":1419.7852854750013,"channel":0,"labels":["Passes completed"]},
    {"start":1419.807180446048,"end":1422.4984020059262,"channel":0,"labels":["Passes completed"]},
    {"start":1425.4190336769732,"end":1429.116805385634,"channel":0,"labels":["Ground duels won"]},
    {"start":1429.8739823283918,"end":1433.1562740697873,"channel":0,"labels":["Dribbles completed"]},
    {"start":1444.415902368657,"end":1450.731197871089,"channel":0,"labels":["Touches"]},
    {"start":1459.5051245302877,"end":1461.901059008184,"channel":0,"labels":["Passes completed"]},
    {"start":1461.9234002176847,"end":1464.0561973829797,"channel":0,"labels":["Ball interception"]},
    {"start":1463.513873979274,"end":1465.3649592798652,"channel":0,"labels":["Passes completed"]},
    {"start":1465.454979939439,"end":1470.7917241787238,"channel":0,"labels":["Passes completed"]},
    {"start":1471.4641207954214,"end":1474.4555765597313,"channel":0,"labels":["Dribbles completed"]},
    {"start":1474.6286932127584,"end":1478.631150230747,"channel":0,"labels":["Ground duels won"]},
    {"start":1478.6666566319475,"end":1480.1901614971478,"channel":0,"labels":["Passes completed"]},
    {"start":1480.9070140002534,"end":1481.1424526483704,"channel":0,"labels":["Touches"]},
    {"start":1482.4024902064791,"end":1490.0888696008863,"channel":0,"labels":["Touches"]},
    {"start":1494.8996056058277,"end":1496.1183468431393,"channel":0,"labels":["Ground duels won"]},
    {"start":1496.277614163924,"end":1502.7314029887775,"channel":0,"labels":["Dribbles completed"]},
    {"start":1508.625183638595,"end":1511.4919954127254,"channel":0,"labels":["Touches"]},
    {"start":1522.3486265657211,"end":1523.6098164632128,"channel":0,"labels":["Passes completed"]},
    {"start":1536.5051506959076,"end":1537.8127704471087,"channel":0,"labels":["Passes completed"]},
    {"start":1537.723378584256,"end":1538.8444043633535,"channel":0,"labels":["Ball interception"]},
    {"start":1539.6904340943718,"end":1541.0892166508313,"channel":0,"labels":["Ground duels won"]},
    {"start":1542.6680405264392,"end":1546.1580722514675,"channel":0,"labels":["Ground duels won"]},
    {"start":1570.6430599323367,"end":1572.2495824724288,"channel":0,"labels":["Ground duels won"]},
    {"start":1572.8038506115836,"end":1581.861313897966,"channel":0,"labels":["Dribbles completed"]},
    {"start":1583.9344272618773,"end":1589.917338790497,"channel":0,"labels":["Dribbles completed"]},
    {"start":1614.2177247333336,"end":1616.198179243965,"channel":0,"labels":["Passes completed"]},
    {"start":1692.09109544269,"end":1695.9512084756634,"channel":0,"labels":["Passes completed"]},
    {"start":1695.6680150848433,"end":1697.845649626436,"channel":0,"labels":["Passes completed"]},
    {"start":1699.2941061723668,"end":1702.8771020295617,"channel":0,"labels":["Passes completed"]},
    {"start":1702.9193754936653,"end":1705.4399539617411,"channel":0,"labels":["Passes completed"]},
    {"start":1706.9979516266117,"end":1709.0167952853335,"channel":0,"labels":["Passes completed"]},
    {"start":1708.866776425495,"end":1710.298917157956,"channel":0,"labels":["Passes completed"]},
    {"start":1711.966219211715,"end":1716.1905266074493,"channel":0,"labels":["Passes completed"]},
    {"start":1716.0518595777828,"end":1718.4477940556794,"channel":0,"labels":["Passes completed"]},
    {"start":1719.6816310687884,"end":1721.85597623081,"channel":0,"labels":["Passes completed"]},
    {"start":1723.948403600443,"end":1725.6641544272484,"channel":0,"labels":["Passes completed"]},
    {"start":1726.5618681097508,"end":1730.0103518380524,"channel":0,"labels":["Passes completed"]},
    {"start":1738.4791476972362,"end":1744.2681685744653,"channel":0,"labels":["Dribbles completed"]},
    {"start":1745.2460124870545,"end":1748.370309584285,"channel":0,"labels":["Passes completed"]},
    {"start":1750.1248719721914,"end":1753.019382410806,"channel":0,"labels":["Passes completed"]},
    {"start":1753.2607584905227,"end":1756.1896768836993,"channel":0,"labels":["Passes completed"]},
    {"start":1767.3670338520744,"end":1771.8885471345402,"channel":0,"labels":["Passes completed"]},
    {"start":1771.8165722553217,"end":1774.3714020408372,"channel":0,"labels":["Passes completed"]},
    {"start":443.74416140808876,"end":446.1684472051462,"channel":0,"labels":["Ball interception"]}
]

# Path to the input video file
input_video_path = "video13.mp4"

# Function to split the video based on time ranges and labels
def split_video(video_path, ranges_with_info):
    video = VideoFileClip(video_path)
    for i, segment_info in enumerate(ranges_with_info):
        start_time = segment_info["start"]
        end_time = segment_info["end"]
        labels = "_".join(segment_info["labels"])  # Join labels with underscores
        # Extract subclip based on start and end times
        subclip = video.subclip(start_time, end_time)
        # Define output folder based on label
        output_folder = "Passes_Completed" if ("Passes completed") in segment_info["labels"] else "Other_Labels"
        # Create folder if it doesn't exist
        if not os.path.exists(output_folder):
            os.makedirs(output_folder)
        # Save subclip to a new file with label name in respective folder
        output_path = os.path.join(output_folder, f"output_clip_{labels}_{i}.mp4")
        subclip.write_videofile(output_path, codec='libx264')
    video.close()

# Call the function to split the video
split_video(input_video_path, time_ranges_with_info)
